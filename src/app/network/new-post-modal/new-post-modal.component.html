<ion-header class="header-clean">
  <ion-toolbar class="toolbar-clean">
    <ion-buttons slot="start">
      <ion-button (click)="closeModal()" class="cancel-btn">
        Cancel
      </ion-button>
    </ion-buttons>
    <ion-title class="page-title">New Post</ion-title>
    <ion-buttons slot="end">
      <ion-button 
        [disabled]="!canPost() || isLoading" 
        (click)="createPost()"
        class="post-btn">
        Post
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="content-wrapper">
    <!-- User Info -->
    <div class="user-section">
      <img 
        [src]="userPhoto" 
        [alt]="userName"
        (error)="onImageError($event)"
        class="avatar" />
      <div class="user-meta">
        <h3>{{ userName }}</h3>
        <p>Posting now</p>
      </div>
    </div>

    <!-- Caption Input - Using native textarea for mobile compatibility -->
    <textarea
      [(ngModel)]="caption"
      placeholder="What's on your mind?"
      class="post-textarea"
      [disabled]="isLoading"></textarea>

    <div class="caption-counter" 
         [class.warning]="caption.length > 2000"
         [class.error]="caption.length > 2500">
      {{ caption.length }} / 2500
    </div>

    <!-- Image Preview -->
    <div *ngIf="selectedImageDataUrl" class="photo-preview">
      <img [src]="selectedImageDataUrl" alt="Selected image" />
      <div class="remove-photo" (click)="removePhoto()">
        <ion-icon name="close"></ion-icon>
      </div>
    </div>

    <!-- Add Photo Button -->
<div class="upload-area">
  <ion-icon name="camera"></ion-icon>
  <span>Add Photo</span>
  <input 
    type="file"
    accept="image/*"
    (change)="onPhotoSelected($event)"
    capture="environment"
    class="upload-input"
  />
</div>

    <!-- Hidden File Input for Web Fallback -->
    <input 
      type="file" 
      id="photoUpload" 
      accept="image/*" 
      (change)="onPhotoSelected($event)"
      style="display: none;" />
  </div>

  <!-- Loading Overlay -->
  <div *ngIf="isLoading" class="loading-overlay">
    <ion-spinner name="crescent"></ion-spinner>
  </div>
</ion-content>